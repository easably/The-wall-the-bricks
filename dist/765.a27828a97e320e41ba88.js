"use strict";(self.webpackChunkthe_wall=self.webpackChunkthe_wall||[]).push([[765],{4765:(w,v,h)=>{h.r(v),h.d(v,{PhrasesComponent:()=>S});var d=h(6304),k=h(7578),t=h(639),u=h(8967),f=h(7709);let M=(()=>{class o{constructor(){this.speechResult=new f.xQ,this.isListening=new f.xQ}start(){var e=this;return(0,d.Z)(function*(){console.log(u.M),(yield u.M.available()).available?(yield u.M.hasPermission()).permission?(e.isListening.next(!0),yield e.startListening()):yield u.M.requestPermission():alert("speech recognition plugin not available on this device")})()}stopListening(){var e=this;return(0,d.Z)(function*(){e.isListening.next(!1),u.M.stop()})()}startListening(){var e=this;return(0,d.Z)(function*(){let s=yield u.M.start({language:"en-US",maxResults:5});yield e.stopListening();let c=[];s.matches.forEach(a=>{c.push(a.toString())}),e.speechResult.next(c)})()}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),y=(()=>{class o{constructor(){this.debugResult=[],this.speechMark=new f.xQ}calculateMark(e,s){this.source=e.toLowerCase().replace(/[.,\/#!?$%\^&\*;:{}=\-_`~()]/g,""),this.recognized=s,console.log(this.source),console.log(this.recognized),this.calculateWholePhrase()}calculateWholePhrase(){let e="",s=0,c=0,a=0,p=0,i=0;this.recognized.forEach(l=>{i=1-this.calculateLevensteinDistance(this.source,l.toLocaleLowerCase().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,""))/Math.max(this.source.length,l.length),s+=i,i>c&&(a=p,c=i,e=l),console.log(`${l} - mark: ${(10*i).toFixed(1)}`),p++}),this.recognized.length>1?this.speechMark.next(10*(c*(.8-.1*a)+(.2+.1*a)*(s-c)/(this.recognized.length-1))):(this.recognized.length=1)?this.speechMark.next(10*c):this.speechMark.next(0)}calculateLevensteinDistance(e,s){if(!e)return s?s.length:0;if(!s)return e.length;for(var c=e.length,a=s.length,p=c+a,i=new Array(c+2),l={},n=0;n<c+2;n++)i[n]=new Array(a+2);for(i[0][0]=p,n=0;n<=c;n++)i[n+1][1]=n,i[n+1][0]=p,l[e[n]]=0;for(var r=0;r<=a;r++)i[1][r+1]=r,i[0][r+1]=p,l[s[r]]=0;for(n=1;n<=c;n++){var x=0;for(r=1;r<=a;r++){var m=l[s[r-1]],b=x;e[n-1]===s[r-1]?(i[n+1][r+1]=i[n][r],x=r):i[n+1][r+1]=Math.min(i[n][r],Math.min(i[n+1][r],i[n][r+1]))+1,i[n+1][r+1]=Math.min(i[n+1][r+1],i[m]?i[m][b]+(n-m-1)+1+(r-b-1):1/0)}l[e[n-1]]=n}return i[c+1][a+1]}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var R=h(8583);const C=function(o){return{pulsation:o}};let S=(()=>{class o{constructor(e,s){this.speechRecogniton=e,this.speechResultEvaluation=s,this.recognized=[],this.source="How can i help you?",this.mark=0,this.isRecognitionStarted=!1}ngOnInit(){this.speechRecogniton.isListening.subscribe(e=>{this.isRecognitionStarted=e}),this.speechRecogniton.speechResult.subscribe(e=>{this.speechRecogniton.stopListening(),this.isRecognitionStarted=!1,console.log("recogniton stopped"),console.log("Result:"+e),this.speechResultEvaluation.calculateMark(this.source,e)}),this.speechResultEvaluation.speechMark.subscribe(e=>{this.mark=e})}onListening(){this.isRecognitionStarted?(this.speechRecogniton.stopListening(),console.log("recogniton stopped")):(this.speechRecogniton.start(),console.log("recognition started"))}refresh(){this.mark=0}listenExample(){var e=this;return(0,d.Z)(function*(){yield k.w.speak({text:e.source})})()}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(M),t.Y36(y))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-phrases"]],decls:12,vars:5,consts:[[1,"source-box"],[1,"buttons-container"],[1,"button","button_small",3,"click"],["src","../../../../assets/bricks/refresh.svg"],[1,"button","button_small",3,"ngClass","click"],["src","../../../../assets/bricks/mic.svg"],["src","../../../../assets/bricks/volume.svg"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"p"),t._uU(2),t.qZA(),t.qZA(),t.TgZ(3,"div",1),t.TgZ(4,"button",2),t.NdJ("click",function(){return s.refresh()}),t._UZ(5,"img",3),t.qZA(),t.TgZ(6,"button",4),t.NdJ("click",function(){return s.onListening()}),t._UZ(7,"img",5),t.qZA(),t.TgZ(8,"button",2),t.NdJ("click",function(){return s.listenExample()}),t._UZ(9,"img",6),t.qZA(),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.qZA()),2&e&&(t.xp6(2),t.Oqu(s.source),t.xp6(4),t.Q6J("ngClass",t.VKq(3,C,s.isRecognitionStarted)),t.xp6(5),t.Oqu(s.mark))},directives:[R.mk],styles:["[_nghost-%COMP%]{width:100%;height:100%;padding:160px 20px 46px;position:absolute;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;z-index:1}.buttons-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;max-width:270px;width:100%}.source-box[_ngcontent-%COMP%]{background-color:#dadada;margin-bottom:30px;max-width:252px;width:100%;text-align:center;padding:18px 12px;border-radius:20px;align-items:center}.source-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#111}.button[_ngcontent-%COMP%]{max-width:56px;width:100%;height:56px;margin-top:15px;background-color:#758fea;border-radius:24px;font-size:24px;color:#fff;transition:all .3s}.button[_ngcontent-%COMP%]:disabled{background-color:#dadada;color:#8f8f8f}.button_small[_ngcontent-%COMP%]{width:48px;height:48px;display:flex;align-items:center;justify-content:center;border-radius:50%}.pulsation[_ngcontent-%COMP%]{animation:pulse 2s infinite;background:red}@keyframes pulse{0%{transform:scale(.95);box-shadow:0 0 #000000b3}70%{transform:scale(1);box-shadow:0 0 0 10px #0000}to{transform:scale(.95);box-shadow:0 0 #0000}}"]}),o})()}}]);